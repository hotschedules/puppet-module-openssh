<% def emit_delimited(key,val,delimiter=' ',record_delimiter="\n") -%>
<%   ret_val = '' -%>
<%   if key.nil? -%>
<%     key = '' -%>
<%     delimiter = '' -%>
<%   end -%>
<%   if val.is_a?(Hash) -%>
<%     sorted_keys = val.keys.sort -%>
<%     sorted_keys.each do |k| -%>
<%       ret_val += emit_delimited(key.to_s + delimiter + k,val[k]) -%>
<%     end -%>
<%   elsif val.is_a?(Array) -%>
<%     val.each do |e| -%>
<%       ret_val += emit_delimited(key,e) -%>
<%     end -%>
<%   else -%>
<%     ret_val += key.to_s + delimiter + val.to_s + record_delimiter -%>
<%   end -%>
<%   return ret_val -%>
<% end -%>
<%= emit_delimited(nil,@sshd_config) -%>
